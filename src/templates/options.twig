{% extends 'pragmatic-cookies/_layout' %}
{% import "_includes/forms" as forms %}

{% set title = 'Appearance'|t('pragmatic-cookies') %}
{% set selectedTab = 'options' %}
{% set _siteHandle = craft.app.request.getQueryParam('site') %}
{% set _siteParam = _siteHandle ? { site: _siteHandle } : {} %}

{% set crumbs = [
  { label: 'Cookies'|t('pragmatic-cookies'), url: url('pragmatic-cookies', _siteParam) },
  { label: 'Appearance'|t('pragmatic-cookies'), url: url('pragmatic-cookies/options', _siteParam) },
] %}

{% block content %}
  <form method="post" accept-charset="UTF-8">
    {{ csrfInput() }}
    {{ actionInput('pragmatic-cookies/default/save-options') }}
    {{ redirectInput('pragmatic-cookies/options', _siteParam) }}

    <h2>{{ 'Layout'|t('pragmatic-cookies') }}</h2>

    {{ forms.selectField({
      label: 'Popup Layout'|t('pragmatic-cookies'),
      id: 'popupLayout',
      name: 'popupLayout',
      value: settings.popupLayout,
      options: [
        { label: 'Bar'|t('pragmatic-cookies'), value: 'bar' },
        { label: 'Box'|t('pragmatic-cookies'), value: 'box' },
        { label: 'Modal'|t('pragmatic-cookies'), value: 'modal' },
      ],
      instructions: 'Choose how the consent popup is displayed.'|t('pragmatic-cookies')
    }) }}

    {{ forms.selectField({
      label: 'Popup Position'|t('pragmatic-cookies'),
      id: 'popupPosition',
      name: 'popupPosition',
      value: settings.popupPosition,
      options: [
        { label: 'Bottom'|t('pragmatic-cookies'), value: 'bottom' },
        { label: 'Top'|t('pragmatic-cookies'), value: 'top' },
        { label: 'Center'|t('pragmatic-cookies'), value: 'center' },
      ],
    }) }}

    <hr>
    <h2>{{ 'Colors'|t('pragmatic-cookies') }}</h2>

    {{ forms.colorField({
      label: 'Primary Color'|t('pragmatic-cookies'),
      id: 'primaryColor',
      name: 'primaryColor',
      value: settings.primaryColor,
      instructions: 'Used for buttons and active toggles.'|t('pragmatic-cookies')
    }) }}

    {{ forms.colorField({
      label: 'Background Color'|t('pragmatic-cookies'),
      id: 'backgroundColor',
      name: 'backgroundColor',
      value: settings.backgroundColor,
    }) }}

    {{ forms.colorField({
      label: 'Text Color'|t('pragmatic-cookies'),
      id: 'textColor',
      name: 'textColor',
      value: settings.textColor,
    }) }}

    <hr>
    <h2>{{ 'Behaviour'|t('pragmatic-cookies') }}</h2>

    {{ forms.lightswitchField({
      label: 'Show Overlay'|t('pragmatic-cookies'),
      id: 'overlayEnabled',
      name: 'overlayEnabled',
      on: settings.overlayEnabled == 'true',
      instructions: 'Show a semi-transparent overlay behind the popup.'|t('pragmatic-cookies')
    }) }}

    {{ forms.lightswitchField({
      label: 'Auto Show Popup'|t('pragmatic-cookies'),
      id: 'autoShowPopup',
      name: 'autoShowPopup',
      on: settings.autoShowPopup == 'true',
      instructions: 'Automatically display the popup on first visit.'|t('pragmatic-cookies')
    }) }}

    {{ forms.textField({
      label: 'Consent Expiry (days)'|t('pragmatic-cookies'),
      id: 'consentExpiry',
      name: 'consentExpiry',
      value: settings.consentExpiry,
      type: 'number',
      instructions: 'Number of days before the consent cookie expires and the popup is shown again.'|t('pragmatic-cookies')
    }) }}

    {{ forms.lightswitchField({
      label: 'Log Consent'|t('pragmatic-cookies'),
      id: 'logConsent',
      name: 'logConsent',
      on: settings.logConsent == 'true',
      instructions: 'Store consent records in the database for compliance purposes.'|t('pragmatic-cookies')
    }) }}

    <div class="btngroup">
      <button type="submit" class="btn submit">{{ 'Save'|t('pragmatic-cookies') }}</button>
    </div>
  </form>
{% endblock %}
